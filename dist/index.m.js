import n from"pg";const t="undefined"!=typeof Symbol?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function e(n,t,o){if(!n.s){if(o instanceof r){if(!o.s)return void(o.o=e.bind(null,n,t));1&t&&(t=o.s),o=o.v}if(o&&o.then)return void o.then(e.bind(null,n,t),e.bind(null,n,2));n.s=t,n.v=o;var i=n.o;i&&i(n)}}var r=/*#__PURE__*/function(){function n(){}return n.prototype.then=function(t,r){var o=new n,i=this.s;if(i){var u=1&i?t:r;if(u){try{e(o,1,u(this.v))}catch(n){e(o,2,n)}return o}return this}return this.o=function(n){try{var i=n.v;1&n.s?e(o,1,t?t(i):i):r?e(o,1,r(i)):e(o,2,i)}catch(n){e(o,2,n)}},o},n}();function o(n){return n instanceof r&&1&n.s}var i=function(){return Promise.resolve()},u=function(){try{if(!f)throw new Error("Database not connected");var n=[{name:"local_logs",columns:[{name:"id",type:"bigserial"},{name:"message",type:"text"},{name:"created_at",type:"timestamp"},{name:"author",type:"uuid"},{name:"type",type:"tinyint"}]}],i=function(n,i,u){if("function"==typeof n[t]){var a,c,f,s=n[t]();if(function n(t){try{for(;!(a=s.next()).done;)if((t=i(a.value))&&t.then){if(!o(t))return void t.then(n,f||(f=e.bind(null,c=new r,2)));t=t.v}c?e(c,1,t):c=t}catch(n){e(c||(c=new r),2,n)}}(),s.return){var h=function(n){try{a.done||s.return()}catch(n){}return n};if(c&&c.then)return c.then(h,function(n){throw h(n)});h()}return c}if(!("length"in n))throw new TypeError("Object is not iterable");for(var l=[],m=0;m<n.length;m++)l.push(n[m]);return function(n,t,i){var u,a,c=-1;return function i(f){try{for(;++c<n.length;)if((f=t(c))&&f.then){if(!o(f))return void f.then(i,a||(a=e.bind(null,u=new r,2)));f=f.v}u?e(u,1,f):u=f}catch(n){e(u||(u=new r),2,n)}}(),u}(l,function(n){return i(l[n])})}(n,function(n){var t=n.columns.map(function(n){return n.name+" "+n.type}).join(", ");return Promise.resolve(f.query("CREATE TABLE IF NOT EXISTS "+n.name+" ("+t+")")).then(function(){})});return Promise.resolve(i&&i.then?i.then(function(){return n}):n)}catch(n){return Promise.reject(n)}},a=function(n){try{return f=new c({user:n.user,password:n.password,host:n.host,port:n.port,database:n.database}),Promise.resolve(f.connect()).then(function(){return f})}catch(n){return Promise.reject(n)}},c=n.Pool,f=null;function s(){return"1.0.0"}export{a as connect,u as createTables,s as getVersion,i as log};
