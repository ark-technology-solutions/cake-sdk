!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("pg")):"function"==typeof define&&define.amd?define(["exports","pg"],t):t((n||self).cakeSdk={},n.pg)}(this,function(n,t){function e(n){return n&&"object"==typeof n&&"default"in n?n:{default:n}}var r=/*#__PURE__*/e(t);const o="undefined"!=typeof Symbol?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function i(n,t,e){if(!n.s){if(e instanceof u){if(!e.s)return void(e.o=i.bind(null,n,t));1&t&&(t=e.s),e=e.v}if(e&&e.then)return void e.then(i.bind(null,n,t),i.bind(null,n,2));n.s=t,n.v=e;var r=n.o;r&&r(n)}}var u=/*#__PURE__*/function(){function n(){}return n.prototype.then=function(t,e){var r=new n,o=this.s;if(o){var u=1&o?t:e;if(u){try{i(r,1,u(this.v))}catch(n){i(r,2,n)}return r}return this}return this.o=function(n){try{var o=n.v;1&n.s?i(r,1,t?t(o):o):e?i(r,1,e(o)):i(r,2,o)}catch(n){i(r,2,n)}},r},n}();function a(n){return n instanceof u&&1&n.s}var f=r.default.Pool,c=null;n.connect=function(n){try{return c=new f({user:n.user,password:n.password,host:n.host,port:n.port,database:n.database}),Promise.resolve(c.connect()).then(function(){return c})}catch(n){return Promise.reject(n)}},n.createTables=function(){try{if(!c)throw new Error("Database not connected");var n=[{name:"local_logs",columns:[{name:"id",type:"bigserial"},{name:"message",type:"text"},{name:"created_at",type:"timestamp"},{name:"author",type:"uuid"},{name:"type",type:"tinyint"}]}],t=function(n,t,e){if("function"==typeof n[o]){var r,f,c,s=n[o]();if(function n(e){try{for(;!(r=s.next()).done;)if((e=t(r.value))&&e.then){if(!a(e))return void e.then(n,c||(c=i.bind(null,f=new u,2)));e=e.v}f?i(f,1,e):f=e}catch(n){i(f||(f=new u),2,n)}}(),s.return){var l=function(n){try{r.done||s.return()}catch(n){}return n};if(f&&f.then)return f.then(l,function(n){throw l(n)});l()}return f}if(!("length"in n))throw new TypeError("Object is not iterable");for(var h=[],d=0;d<n.length;d++)h.push(n[d]);return function(n,t,e){var r,o,f=-1;return function e(c){try{for(;++f<n.length;)if((c=t(f))&&c.then){if(!a(c))return void c.then(e,o||(o=i.bind(null,r=new u,2)));c=c.v}r?i(r,1,c):r=c}catch(n){i(r||(r=new u),2,n)}}(),r}(h,function(n){return t(h[n])})}(n,function(n){var t=n.columns.map(function(n){return n.name+" "+n.type}).join(", ");return Promise.resolve(c.query("CREATE TABLE IF NOT EXISTS "+n.name+" ("+t+")")).then(function(){})});return Promise.resolve(t&&t.then?t.then(function(){return n}):n)}catch(n){return Promise.reject(n)}},n.getVersion=function(){return"1.0.0"},n.log=function(){return Promise.resolve()}});
